<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component/dist/aframe-environment-component.min.js"></script>
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
      {
        "imports": {
          "three": "https://unpkg.com/three@0.155.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@0.155.0/examples/jsm/"
        }
      }
    </script>
  </head>
  <body>
    <a-scene log="scene rendererd!" cursor="rayOrigin: mouse">
      <!-- Panel -->
      <a-entity log="entity rendererd!"
        environment="preset: starry;
                    groundTexture: walkernoise;
                    ground: hills;
                    groundColor: #00b5ec;
                    groundColor2: #33ac6a; 
                    skyColor: #33ac6a;
                    skyType: atmosphere;
                    lighting: distant;
                    dressing: pyramids;
                    shadow: true;
                    fog:0.5;
                    grid: dots">

                    <a-plane log="plane rendered!"
                        position="0 2.5 -3" rotation="0 0 0" 
                        width="3.5" height="2" opacity="0.4"  geometry="primitive: box" material="color: #FAFAFA"
                        animation="property: rotation; from: 90 0 0; to: 0 0 0; dur: 750; delay: 500"
                        id="menu-panel" intersect-color-change>
                        <!-- Menu Items -->
                        <a-text position="-0.5 0.60 0" value="Therapy" id="therapy-menu"></a-text>
                        <a-text position="-0.5 0.00 0" value="Fitness" id="fitness-menu"></a-text>
                        <a-text position="-0.5 -0.60 0" value="Exit" id="exit-menu"></a-text>
                    </a-plane> 
                        
        </a-entity>

        <a-entity position="0 1.6 0" camera look-controls wasd-controls></a-entity>
        <a-entity id="leftHand" laser-controls="hand: left" raycaster="objects: [mixin='box']"></a-entity>
        <a-entity id="rightHand" laser-controls="hand: right" raycaster="objects: [mixin='box']" line="color: #118A7E"></a-entity>
    </a-scene>

    <script>
        /**
         * Change color if entity when intersected by raycaster.
         */
        AFRAME.registerComponent('intersect-color-change', {
          init: function () {
            var el = this.el;
            var material = el.getAttribute('material');
            var initialColor = material.color;
            var self = this;

            el.addEventListener('mousedown', function (evt) {
              el.setAttribute('material', 'color', '#EF2D5E');
            });

            el.addEventListener('mouseup', function (evt) {
              el.setAttribute('material', 'color', self.isMouseEnter ? '#24CAFF' : initialColor);
            });

            el.addEventListener('mouseenter', function () {
              el.setAttribute('material', 'color', '#24CAFF');
              self.isMouseEnter = true;
            });

            el.addEventListener('mouseleave', function () {
              el.setAttribute('material', 'color', initialColor);
              self.isMouseEnter = false;
            });
          }
        });
    </script>
  </body>
</html>
